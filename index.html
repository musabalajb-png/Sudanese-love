<!DOCTYPE html>
<html lang="ar" dir="rtl" id="mainHtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="mainTitle">Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ | Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„Ø³ØªØ± ÙˆØ§Ù„Ø²ÙˆØ§Ø¬ Ø§Ù„Ø­Ù„Ø§Ù„</title>
    <meta name="description" content="Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù‡ÙŠ Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø±Ø§Ø¦Ø¯Ø© ÙÙŠ Ø§Ù„Ø³ÙˆØ¯Ø§Ù† Ù„ØªÙˆÙÙŠÙ‚ Ø§Ù„Ø±Ø£Ø³ÙŠÙ† Ø¨Ø§Ù„Ø­Ù„Ø§Ù„.">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --main-font: 'Cairo', sans-serif; }
        [dir="ltr"] { --main-font: 'Poppins', sans-serif; }
        body { font-family: var(--main-font); background: #fafafa; overflow-x: hidden; scroll-behavior: smooth; }
        .hero-gradient { background: linear-gradient(135deg, #15803d 0%, #14532d 100%); }
        .pulse-btn { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(21, 128, 61, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(21, 128, 61, 0); } 100% { box-shadow: 0 0 0 0 rgba(21, 128, 61, 0); } }
        #loginModal, #regModal { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .lang-switcher {
            position: fixed; top: 100px; left: 20px; z-index: 100;
            background: white; padding: 8px 15px; border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 1px solid #eee;
            cursor: pointer; font-weight: bold; font-size: 12px; transition: 0.3s;
        }
        [dir="ltr"] .lang-switcher { left: auto; right: 20px; }
        .form-input { @apply w-full bg-slate-50 border border-transparent rounded-xl p-3 text-sm focus:border-green-500 focus:bg-white focus:ring-4 focus:ring-green-500/10 outline-none transition-all; }
        .form-label { @apply block text-[10px] font-bold text-slate-600 mb-1 px-1; }
        #loadingOverlay { display: none; position: fixed; inset: 0; background: rgba(255,255,255,0.95); z-index: 1000; flex-direction: column; align-items: center; justify-content: center; }
        .toast-active { transform: translateY(0) !important; opacity: 1 !important; }
    </style>
</head>
<body>

    <div id="loadingOverlay">
        <div class="relative">
            <div class="w-20 h-20 border-4 border-green-100 rounded-full"></div>
            <div class="w-20 h-20 border-4 border-green-700 border-t-transparent rounded-full animate-spin absolute top-0"></div>
        </div>
        <p class="mt-6 font-bold text-green-800 text-lg animate-pulse" id="loadingText">Ø¬Ø§Ø±ÙŠ ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø§ØªØµØ§Ù„...</p>
    </div>

    <div onclick="toggleLang()" id="langBtn" class="lang-switcher shadow-lg hover:scale-105 active:scale-95 transition">English</div>

    <nav class="bg-white/90 backdrop-blur-lg shadow-sm p-4 sticky top-0 z-50 border-b border-gray-100">
        <div class="container mx-auto flex justify-between items-center px-4">
            <div class="flex items-center gap-2 group cursor-pointer" onclick="window.scrollTo(0,0)">
                <span class="text-3xl group-hover:rotate-12 transition">ğŸ’</span>
                <span class="font-black text-green-800 text-xl tracking-tight" data-ar="Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ" data-en="Naseeb Global">Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</span>
            </div>
            <div class="flex items-center gap-4">
                <div id="userSection" class="hidden flex items-center gap-3 bg-green-50/50 px-4 py-2 rounded-2xl border border-green-100 shadow-inner"></div>
                <button onclick="toggleRegModal(true)" class="text-green-700 font-bold hover:text-green-900 text-sm hidden md:block transition" data-ar="ÙØªØ­ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯" data-en="Create Account">ÙØªØ­ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
                <button id="loginBtnNav" onclick="toggleModal(true)" class="bg-green-700 text-white px-7 py-2.5 rounded-full text-sm font-bold pulse-btn hover:bg-green-800 transition" data-ar="ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„" data-en="Login">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            </div>
        </div>
    </nav>

    <header class="hero-gradient text-white py-32 px-6 relative overflow-hidden">
        <div class="absolute inset-0 opacity-10" style="background-image: url('https://www.transparenttextures.com/patterns/arabesque.png');"></div>
        <div class="container mx-auto relative z-10 text-center">
            <h1 class="text-5xl md:text-7xl font-black mb-8 leading-tight" data-ar="Ù…ÙØ­ÙŠØ·Ùƒ Ù„Ù„Ø³ØªØ± ÙˆØ§Ù„Ø­Ù„Ø§Ù„" data-en="Your Secure Path to Halal">Ù…ÙØ­ÙŠØ·Ùƒ Ù„Ù„Ø³ØªØ± ÙˆØ§Ù„Ø­Ù„Ø§Ù„ <br><span class="text-green-300 font-light text-3xl md:text-5xl" data-ar="Ø¨Ù…Ø¹Ø§ÙŠÙŠØ± Ø¥Ø³Ù„Ø§Ù…ÙŠØ© ÙˆØ®ØµÙˆØµÙŠØ© ÙØ§Ø¦Ù‚Ø©" data-en="With Islamic Standards">Ø¨Ù…Ø¹Ø§ÙŠÙŠØ± Ø¥Ø³Ù„Ø§Ù…ÙŠØ© ÙˆØ®ØµÙˆØµÙŠØ© ÙØ§Ø¦Ù‚Ø©</span></h1>
            <div class="flex flex-wrap justify-center gap-4">
                <button onclick="toggleRegModal(true)" class="bg-white text-green-800 px-14 py-4 rounded-2xl font-bold text-xl shadow-2xl hover:shadow-white/20 transition transform hover:-translate-y-1" data-ar="Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø¢Ù†" data-en="Start Journey">Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø¢Ù†</button>
            </div>
        </div>
    </header>

    <section id="pricing" class="py-24 bg-slate-50 px-6">
        <div class="container mx-auto max-w-6xl">
            <h2 class="text-center text-3xl font-black text-slate-800 mb-16" data-ar="Ø§Ø®ØªØ± Ø¨Ø§Ù‚Ø© Ø§Ù„Ø³ØªØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ùƒ" data-en="Choose Your Plan">Ø§Ø®ØªØ± Ø¨Ø§Ù‚Ø© Ø§Ù„Ø³ØªØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ùƒ</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
                <div class="bg-white p-10 rounded-[3rem] shadow-xl border border-slate-100 text-center">
                    <div class="w-16 h-16 bg-green-50 rounded-3xl flex items-center justify-center text-3xl mx-auto mb-6">ğŸŒ¿</div>
                    <h3 class="font-bold text-2xl mb-2 text-slate-800" data-ar="Ø¨Ø§Ù‚Ø© Ø§Ù„Ø³ØªØ±" data-en="Sutra Plan">Ø¨Ø§Ù‚Ø© Ø§Ù„Ø³ØªØ±</h3>
                    <div class="text-3xl font-black text-green-700 mb-8" id="price-sutra">...</div>
                    <ul class="text-slate-500 text-sm mb-10 space-y-4 text-right pr-4">
                        <li><i class="fas fa-check-circle text-green-500 ml-2"></i> ØªØµÙØ­ Ø£ÙƒØ«Ø± Ù…Ù† 5000 Ù…Ù„Ù</li>
                        <li><i class="fas fa-check-circle text-green-500 ml-2"></i> Ø¥Ø±Ø³Ø§Ù„ ÙˆØ±Ø¯Ø§Øª ØªØ¹Ø§Ø±Ù Ù…Ø­Ø¯ÙˆØ¯</li>
                    </ul>
                    <button onclick="safeRedirect('Sutra')" class="w-full py-4 rounded-2xl bg-slate-100 text-slate-700 font-bold hover:bg-green-700 hover:text-white transition-all">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø§Ù‚Ø©</button>
                </div>
                <div class="bg-white p-10 rounded-[3rem] shadow-2xl border-2 border-green-500 text-center relative transform md:-translate-y-4">
                    <div class="absolute -top-5 right-10 bg-yellow-400 text-green-900 text-[10px] font-black px-6 py-2 rounded-full shadow-lg uppercase" data-ar="Ø§Ù„Ø£ÙƒØ«Ø± Ø£Ù…Ø§Ù†Ø§Ù‹" data-en="Most Secure">Ø§Ù„Ø£ÙƒØ«Ø± Ø£Ù…Ø§Ù†Ø§Ù‹</div>
                    <div class="w-16 h-16 bg-yellow-50 rounded-3xl flex items-center justify-center text-3xl mx-auto mb-6">â­</div>
                    <h3 class="font-bold text-2xl mb-2 text-slate-800" data-ar="Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©" data-en="Gold Plan">Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©</h3>
                    <div class="text-3xl font-black text-green-700 mb-8" id="price-gold">...</div>
                    <ul class="text-slate-500 text-sm mb-10 space-y-4 text-right pr-4">
                        <li><i class="fas fa-star text-yellow-500 ml-2"></i> Ø±Ø¤ÙŠØ© Ø§Ù„ØµÙˆØ± Ø§Ù„Ø´Ø®ØµÙŠØ©</li>
                        <li><i class="fas fa-star text-yellow-500 ml-2"></i> Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ø¸Ù‡ÙˆØ± Ù„Ù„Ø¬Ø§Ø¯ÙŠÙ†</li>
                    </ul>
                    <button onclick="safeRedirect('Gold')" class="w-full py-4 rounded-2xl bg-green-700 text-white font-bold shadow-xl hover:scale-105 transition-all">Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù†</button>
                </div>
                <div class="bg-slate-900 p-10 rounded-[3rem] shadow-2xl text-white text-center">
                    <div class="w-16 h-16 bg-white/10 rounded-3xl flex items-center justify-center text-3xl mx-auto mb-6">ğŸ’</div>
                    <h3 class="font-bold text-2xl mb-2 text-green-400" data-ar="Ø¨Ø§Ù‚Ø© ÙƒØ¨Ø§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ§Øª" data-en="VIP Plan">Ø¨Ø§Ù‚Ø© ÙƒØ¨Ø§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ§Øª</h3>
                    <div class="text-3xl font-black mb-8 text-white" id="price-vip">...</div>
                    <ul class="text-slate-400 text-sm mb-10 space-y-4 text-right pr-4">
                        <li><i class="fas fa-crown text-green-400 ml-2"></i> Ø®Ø· Ø³Ø§Ø®Ù† Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</li>
                        <li><i class="fas fa-crown text-green-400 ml-2"></i> ØªÙˆÙÙŠÙ‚ ÙŠØ¯ÙˆÙŠ Ù…Ù† Ø§Ù„Ø®Ø¨Ø±Ø§Ø¡</li>
                    </ul>
                    <button onclick="safeRedirect('VIP')" class="w-full py-4 rounded-2xl bg-green-600 text-white font-bold hover:bg-green-500 transition-all">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø©</button>
                </div>
            </div>
        </div>
    </section>

    <div id="regModal" class="hidden fixed inset-0 bg-slate-900/80 backdrop-blur-md z-[100] flex items-center justify-center p-4 opacity-0 overflow-y-auto">
        <div class="bg-white w-full max-w-lg rounded-[2.5rem] p-10 shadow-2xl relative scale-95 transition-all text-right">
            <button onclick="toggleRegModal(false)" class="absolute top-8 left-8 text-slate-300 hover:text-red-500 transition"><i class="fas fa-times-circle text-2xl"></i></button>
            <h3 class="text-2xl font-black text-slate-800 mb-2" data-ar="Ø§Ù†Ø¶Ù… Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ø³ØªØ±" data-en="Join Us">Ø§Ù†Ø¶Ù… Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ø³ØªØ±</h3>
            <p class="text-slate-400 text-xs mb-8" data-ar="Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø­Ù…ÙŠØ© Ø¨ØªØ´ÙÙŠØ± 256-Ø¨Øª" data-en="Data encrypted with 256-bit">Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø­Ù…ÙŠØ© Ø¨ØªØ´ÙÙŠØ± 256-Ø¨Øª</p>
            
            <form id="regForm" class="grid grid-cols-2 gap-5" onsubmit="return false;">
                <div class="col-span-2">
                    <label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ (Ø³Ø±ÙŠ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©)</label>
                    <input type="text" id="regName" class="form-input" required placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ">
                </div>
                <div>
                    <label class="form-label">Ø§Ù„Ø¹Ù…Ø±</label>
                    <input type="number" id="regAge" class="form-input" required min="18" max="70">
                </div>
                <div>
                    <label class="form-label">Ø§Ù„Ø·ÙˆÙ„</label>
                    <input type="number" id="regHeight" class="form-input" required>
                </div>
                <div class="col-span-2">
                    <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ù†ØµØ©</label>
                    <input type="password" id="regPass" class="form-input" required>
                </div>
                <div class="col-span-2">
                    <label class="form-label">Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© (ØªØ¸Ù‡Ø± Ù„Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© ÙÙ‚Ø·)</label>
                    <div class="relative group">
                        <input type="file" id="regPhoto" class="form-input opacity-0 absolute inset-0 z-10 cursor-pointer" accept="image/*" required onchange="updateFileName(this)">
                        <div class="bg-slate-50 border-2 border-dashed border-slate-200 p-4 rounded-xl text-center group-hover:border-green-500 transition" id="filePlaceholder">
                            <i class="fas fa-cloud-upload-alt text-slate-300 text-2xl mb-1"></i>
                            <p class="text-[10px] text-slate-500" id="fileNameText">Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©</p>
                        </div>
                    </div>
                </div>
                <button type="button" onclick="secureSubmit()" id="regBtn" class="col-span-2 bg-green-700 text-white py-4 rounded-2xl font-bold shadow-xl shadow-green-900/20 hover:bg-green-800 transition transform active:scale-95">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ğŸ›¡ï¸</button>
            </form>
        </div>
    </div>

    <div id="loginModal" class="hidden fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4 opacity-0">
        <div class="bg-white w-full max-w-md rounded-[2.5rem] p-10 shadow-2xl relative scale-95 transition-all">
            <h3 class="text-2xl font-black text-center mb-8 text-slate-800">Ø§Ù„ÙˆÙ„ÙˆØ¬ Ù„Ù„Ù…Ù†ØµØ©</h3>
            <div class="space-y-5">
                <input type="text" id="loginName" class="form-input" placeholder="Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø¹Ø±Ù">
                <input type="password" id="loginPass" class="form-input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                <button onclick="handleLogin()" id="submitLogin" class="w-full bg-green-700 text-white py-4 rounded-2xl font-bold hover:shadow-lg transition">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù† ğŸ”’</button>
            </div>
        </div>
    </div>

    <script>
        const CONFIG = {
            sheetUrl: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRHsoqVm7cDIUgGw6u5n0yO8U19lyqKLrrskUn6Q7At1Q04hrXdC7HxojsDnxj7Frld2__eJOBBMEX6/pub?output=csv",
            imgbbKey: "847040441499990666014e2d31221b21",
            lang: localStorage.getItem('app_lang') || 'ar',
            adminPhone: "249127910778",
            sessionExpiry: 3600000,
            // Ù…ØµÙÙˆÙØ© Ø§Ù„Ø¹Ù…Ù„Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ø­Ø¯Ø«Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆÙ„Ø©
            pricingMatrix: {
                "SD": { currency: "SDG", sutra: "15,000", gold: "35,000", vip: "75,000" },
                "SA": { currency: "SAR", sutra: "100", gold: "250", vip: "500" },
                "AE": { currency: "AED", sutra: "100", gold: "250", vip: "500" },
                "QA": { currency: "QAR", sutra: "100", gold: "250", vip: "500" },
                "EG": { currency: "EGP", sutra: "1,200", gold: "3,000", vip: "6,000" },
                "DEFAULT": { currency: "USD", sutra: "25", gold: "60", vip: "125" }
            },
            userCountry: "DEFAULT"
        };

        // ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ IP ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù…Ù„Ø©
        async function detectLocationAndCurrency() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                if(CONFIG.pricingMatrix[data.country_code]) {
                    CONFIG.userCountry = data.country_code;
                }
            } catch (e) {
                console.log("Using default currency");
            }
            updatePricingDisplay();
        }

        function updatePricingDisplay() {
            const p = CONFIG.pricingMatrix[CONFIG.userCountry];
            document.getElementById('price-sutra').innerHTML = `${p.sutra} <span class="text-sm font-normal opacity-60">${p.currency}</span>`;
            document.getElementById('price-gold').innerHTML = `${p.gold} <span class="text-sm font-normal opacity-60">${p.currency}</span>`;
            document.getElementById('price-vip').innerHTML = `${p.vip} <span class="text-sm font-normal opacity-60">${p.currency}</span>`;
        }

        function safeRedirect(plan) {
            const p = CONFIG.pricingMatrix[CONFIG.userCountry];
            const priceVal = plan === 'Sutra' ? p.sutra : (plan === 'Gold' ? p.gold : p.vip);
            const msg = `Ø£Ø±ÙŠØ¯ ØªÙØ¹ÙŠÙ„ ${plan} Ø¨Ù‚ÙŠÙ…Ø© ${priceVal} ${p.currency} ÙÙŠ Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ. (Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${CONFIG.userCountry})`;
            window.open(`https://wa.me/${CONFIG.adminPhone}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        // Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ© Ø§Ù„Ø£Ø®Ø±Ù‰ (Ø¯ÙˆÙ† Ø£ÙŠ ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ Ø­Ø°Ù)
        function secureLocalStorage() {
            const originalSetItem = localStorage.setItem;
            localStorage.setItem = function(key, value) {
                if (key === 'naseeb_logged') {
                    const expiry = Date.now() + CONFIG.sessionExpiry;
                    originalSetItem.apply(this, [key, value]);
                    originalSetItem.apply(this, ['session_expiry', expiry]);
                } else {
                    originalSetItem.apply(this, [key, value]);
                }
            };
        }
        secureLocalStorage();

        function toggleModal(show) { toggleEl('loginModal', show); }
        function toggleRegModal(show) { toggleEl('regModal', show); }
        function toggleEl(id, show) {
            const el = document.getElementById(id);
            if(show) { el.classList.remove('hidden'); setTimeout(() => el.classList.add('opacity-100'), 10); }
            else { el.classList.remove('opacity-100'); setTimeout(() => el.classList.add('hidden'), 300); }
        }

        function updateFileName(input) {
            const text = input.files[0] ? input.files[0].name : "Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©";
            document.getElementById('fileNameText').innerText = text;
            document.getElementById('filePlaceholder').classList.add('border-green-500', 'bg-green-50');
        }

        async function secureSubmit() {
            const fileInput = document.getElementById('regPhoto');
            const overlay = document.getElementById('loadingOverlay');
            if (!fileInput.files[0]) { showSimpleToast("ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„", "error"); return; }
            overlay.style.display = 'flex';
            try {
                const formData = new FormData();
                formData.append("image", fileInput.files[0]);
                const res = await fetch(`https://api.imgbb.com/1/upload?key=${CONFIG.imgbbKey}`, { method: "POST", body: formData });
                const result = await res.json();
                if (result.success) {
                    const photoUrl = result.data.url;
                    const msg = `ğŸ›¡ï¸ Ø·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯:\nğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${document.getElementById('regName').value}\nğŸ”‘ Ø§Ù„Ø³Ø±: ${document.getElementById('regPass').value}\nğŸ–¼ï¸ Ø§Ù„ØµÙˆØ±Ø©: ${photoUrl}`;
                    setTimeout(() => {
                        window.open(`https://wa.me/${CONFIG.adminPhone}?text=${encodeURIComponent(msg)}`, '_blank');
                        overlay.style.display = 'none';
                        location.reload();
                    }, 1000);
                }
            } catch (e) { overlay.style.display = 'none'; showSimpleToast("Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹", "error"); }
        }

        async function handleLogin() {
            const user = document.getElementById('loginName').value.trim();
            const pass = document.getElementById('loginPass').value.trim();
            if(!user || !pass) return;
            document.getElementById('submitLogin').disabled = true;
            try {
                const res = await fetch(CONFIG.sheetUrl + "?t=" + Date.now());
                const text = await res.text();
                const rows = text.split('\n').slice(1);
                for(let row of rows) {
                    const cols = row.split(',').map(c => c.trim().replace(/^"|"$/g, ''));
                    if(cols[0] === user && cols[1] === pass) {
                        localStorage.setItem('naseeb_logged', 'true');
                        localStorage.setItem('userName', user);
                        window.location.href = 'members.html';
                        return;
                    }
                }
                showSimpleToast("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©", "error");
            } catch(e) { showSimpleToast("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…", "error"); }
            document.getElementById('submitLogin').disabled = false;
        }

        function showSimpleToast(text, type = "success") {
            const toast = document.createElement('div');
            toast.className = `fixed bottom-8 left-1/2 -translate-x-1/2 px-8 py-4 rounded-2xl shadow-2xl z-[200] transition-all duration-500 transform translate-y-20 opacity-0 font-bold text-sm flex items-center gap-3 ${type === 'success' ? 'bg-white text-green-800' : 'bg-red-600 text-white'}`;
            toast.innerHTML = `<i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-triangle'}"></i> ${text}`;
            document.body.appendChild(toast);
            setTimeout(() => toast.classList.add('toast-active'), 100);
            setTimeout(() => { toast.classList.remove('toast-active'); setTimeout(() => toast.remove(), 500); }, 3500);
        }

        function toggleLang() {
            CONFIG.lang = CONFIG.lang === 'ar' ? 'en' : 'ar';
            localStorage.setItem('app_lang', CONFIG.lang);
            location.reload();
        }

        window.onload = () => {
            const expiry = localStorage.getItem('session_expiry');
            if (expiry && Date.now() > expiry) { localStorage.clear(); location.reload(); }
            const html = document.getElementById('mainHtml');
            html.dir = CONFIG.lang === 'ar' ? 'rtl' : 'ltr';
            document.querySelectorAll('[data-ar]').forEach(el => el.innerText = el.getAttribute(`data-${CONFIG.lang}`));
            
            // ØªØ´ØºÙŠÙ„ ÙƒØ´Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹
            detectLocationAndCurrency();

            if(localStorage.getItem('naseeb_logged') === 'true') {
                document.getElementById('loginBtnNav').classList.add('hidden');
                const sec = document.getElementById('userSection');
                sec.classList.remove('hidden');
                sec.innerHTML = `<span class="font-black text-green-900 text-xs">ğŸ›¡ï¸ ${localStorage.getItem('userName')}</span><button onclick="localStorage.clear(); location.reload();" class="text-slate-400 ml-2"><i class="fas fa-sign-out-alt"></i></button>`;
            }
        };
    </script>
</body>
</html>
