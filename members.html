<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ | Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ø§Ø±Ù ÙˆØ§Ù„Ø²ÙˆØ§Ø¬ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠ Ø§Ù„Ø£ÙˆÙ„Ù‰</title>
    <meta name="description" content="Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù‡ÙŠ Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„Ø³ØªØ± ÙˆØ§Ù„Ø­Ù„Ø§Ù„ ÙÙŠ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†. Ø§Ø¨Ø­Ø« Ø¹Ù† Ø´Ø±ÙŠÙƒ Ø§Ù„Ø¹Ù…Ø± ÙÙŠ Ø¨ÙŠØ¦Ø© Ø¢Ù…Ù†Ø© ØªØ¶Ù…Ù† Ø§Ù„Ø®ØµÙˆØµÙŠØ© ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©.">
    <meta name="keywords" content="Ø²ÙˆØ§Ø¬ Ø³ÙˆØ¯Ø§Ù†ÙŠ, Ù†ØµÙŠØ¨, Ø®Ø·Ø§Ø¨Ø© Ø³ÙˆØ¯Ø§Ù†ÙŠØ©, Ø²ÙˆØ§Ø¬ Ø­Ù„Ø§Ù„, Ø³ØªØ±, Ø²ÙˆØ§Ø¬ Ø§Ù„Ø®Ø±Ø·ÙˆÙ…, Ø¨Ù†Ø§Øª Ø§Ù„Ø³ÙˆØ¯Ø§Ù† Ù„Ù„Ø²ÙˆØ§Ø¬, Ù…ØºØªØ±Ø¨ÙŠÙ† Ø§Ù„Ø³ÙˆØ¯Ø§Ù†">
    <meta name="author" content="Ø§Ù„Ù…ØµØ¹Ø¨ - Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ">
    
    <meta property="og:title" content="Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ | Ø§Ø¨Ø­Ø« Ø¹Ù† Ù†ØµÙŠØ¨Ùƒ Ø§Ù„Ø¢Ù†">
    <meta property="og:description" content="Ù…Ù†ØµØ© Ø¢Ù…Ù†Ø© ÙˆÙ…ÙˆØ«ÙˆÙ‚Ø© Ù„Ù„Ø²ÙˆØ§Ø¬ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠ. Ø®ØµÙˆØµÙŠØ© ØªØ§Ù…Ø© Ù„ÙƒÙ„ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡.">
    <meta property="og:image" content="https://musabalajb-png.github.io/Sudanese-love/logo.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --primary-green: #16a34a; --heart-pink: rgba(255, 182, 193, 0.4); }
        body { font-family: 'Cairo', sans-serif; background: #f0f4f8; overflow-x: hidden; margin: 0; user-select: none; }
        
        .bg-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(45deg, #fff5f5, #f0fdf4, #f5f3ff, #fff9db); background-size: 400% 400%; animation: gradientBG 15s ease infinite; z-index: -2; }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .heart-bg { position: fixed; color: var(--heart-pink); font-size: 20px; pointer-events: none; z-index: -1; animation: fall linear infinite; }
        @keyframes fall { from { transform: translateY(-10vh) rotate(0deg); opacity: 1; } to { transform: translateY(110vh) rotate(360deg); opacity: 0; } }

        .member-card { border-radius: 2.5rem; background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(10px); transition: 0.4s; position: relative; border: 1.5px solid rgba(255, 255, 255, 0.5); overflow: hidden; display: flex; flex-direction: column; }
        .member-card:hover { transform: scale(1.03) translateY(-8px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .img-box { width: 100%; padding-top: 115%; position: relative; overflow: hidden; background: #f1f5f9; }
        .img-box img { position: absolute; top:0; left:0; width:100%; height:100%; object-fit: cover; transition: 0.8s; }
        
        .blur-effect { filter: blur(25px); transform: scale(1.2); pointer-events: none; }
        .premium-badge { position: absolute; top: 10px; right: 10px; background: linear-gradient(to left, #fbbf24, #f59e0b); color: white; padding: 4px 10px; border-radius: 12px; font-size: 10px; font-weight: 900; z-index: 10; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        
        .blur-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.25); display: flex; align-items: center; justify-content: center; z-index: 5; backdrop-filter: blur(2px); }
        .blur-text { background: white; padding: 6px 15px; border-radius: 50px; font-size: 11px; font-weight: 900; color: #16a34a; box-shadow: 0 10px 20px rgba(0,0,0,0.2); cursor: pointer; border: 2px solid #16a34a; }

        .online-dot { position: absolute; bottom: 10px; left: 10px; width: 12px; height: 12px; background: #22c55e; border-radius: 50%; border: 2px solid white; z-index: 10; }
        .dot-pulse { animation: dot-pulse 2s infinite; }
        @keyframes dot-pulse { 0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); } 70% { box-shadow: 0 0 0 8px rgba(34, 197, 94, 0); } 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); } }

        .stat-badge { background: rgba(22, 163, 74, 0.1); color: #16a34a; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: bold; border: 1px solid rgba(22, 163, 74, 0.2); }

        #notificationPanel { position: fixed; bottom: 90px; left: 20px; right: 20px; max-width: 350px; max-height: 450px; background: white; border-radius: 30px; box-shadow: 0 20px 50px rgba(0,0,0,0.25); z-index: 2000; overflow-y: auto; display: none; border: 3px solid #ef4444; }
        .music-btn { position: fixed; bottom: 25px; left: 25px; width: 55px; height: 55px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 25px rgba(0,0,0,0.15); z-index: 1000; cursor: pointer; color: var(--primary-green); transition: 0.3s; }
    </style>
</head>
<body class="pb-24">

    <div id="loadingMembers" class="fixed inset-0 bg-white z-[5000] flex flex-col items-center justify-center">
        <div class="w-20 h-20 border-8 border-green-100 border-t-green-600 rounded-full animate-spin"></div>
        <p class="mt-6 font-bold text-green-800 animate-pulse text-lg">Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ù†ØµÙŠØ¨Ùƒ...</p>
    </div>

    <div class="bg-canvas"></div>
    <div id="heartsContainer"></div>

    <div class="music-btn" id="musicToggle" onclick="toggleMusic()">
        <i class="fas fa-music text-xl"></i>
        <audio id="bgAudio" loop preload="auto">
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
        </audio>
    </div>

    <button onclick="toggleNotifications()" class="fixed bottom-6 right-6 w-16 h-16 bg-red-500 text-white rounded-full shadow-2xl z-[2100] flex items-center justify-center transition-all active:scale-90">
        <i class="fas fa-bell text-2xl"></i>
        <span id="notifBadge" class="absolute -top-1 -left-1 bg-yellow-400 text-red-700 text-[12px] w-7 h-7 rounded-full flex items-center justify-center font-black border-2 border-white hidden">0</span>
    </button>

    <div id="notificationPanel" class="p-5">
        <div class="flex justify-between items-center mb-4 border-b pb-3 text-slate-800">
            <h4 class="font-bold">Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª ÙˆØµÙ„ØªÙ†ÙŠ</h4>
            <button onclick="toggleNotifications()"><i class="fas fa-times"></i></button>
        </div>
        <div id="notifList"></div>
    </div>

    <nav class="bg-white/80 backdrop-blur-lg shadow-sm p-4 sticky top-0 z-50 border-b border-white/30">
        <div class="container mx-auto flex justify-between items-center px-2">
            <div class="flex items-center gap-2">
                <div class="w-10 h-10 bg-green-600 rounded-2xl flex items-center justify-center text-white shadow-lg"><i class="fas fa-ring"></i></div>
                <span class="font-black text-green-700 text-2xl tracking-tighter">Ù†ØµÙŠØ¨</span>
            </div>
            <div class="flex items-center gap-3">
                <div class="stat-badge hidden md:block">Ù†Ø´Ø· Ø§Ù„Ø¢Ù†: <span id="onlineCount">0</span></div>
                <button onclick="logout()" class="w-10 h-10 bg-slate-50 text-slate-400 rounded-2xl flex items-center justify-center hover:bg-red-50 hover:text-red-500 transition-all"><i class="fas fa-sign-out-alt"></i></button>
            </div>
        </div>
    </nav>

    <div class="container mx-auto p-5">
        <div class="bg-white/60 backdrop-blur-2xl rounded-[2rem] p-4 shadow-xl flex items-center gap-3 mb-8 border border-white">
            <i class="fas fa-search text-slate-400 mr-2"></i>
            <input type="text" id="searchInput" onkeyup="filterMembers()" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø´Ø±ÙŠÙƒ Ø§Ù„Ø¹Ù…Ø± Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©..." class="w-full bg-transparent outline-none font-bold text-slate-700">
        </div>

        <div id="suggestionSection" class="hidden mb-12">
            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-amber-400 rounded-full flex items-center justify-center text-white shadow-lg shadow-amber-200"><i class="fas fa-star text-xs"></i></div>
                    <h3 class="font-black text-slate-700" id="suggestTitle">Ù…Ù‚ØªØ±Ø­ Ù„Ùƒ Ù…Ù† Ù…Ù†Ø·Ù‚ØªÙƒ</h3>
                </div>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6" id="suggestGrid"></div>
            <hr class="mt-10 border-slate-200 opacity-50">
        </div>

        <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-green-600 rounded-full flex items-center justify-center text-white shadow-lg shadow-green-200"><i class="fas fa-users text-xs"></i></div>
                <h3 class="font-black text-slate-700">Ø§ÙƒØªØ´Ù Ø´Ø±ÙŠÙƒ Ø­ÙŠØ§ØªÙƒ</h3>
            </div>
            <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest" id="totalCountDisplay">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</span>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6" id="membersGrid"></div>
    </div>

    <script>
        const CONFIG = {
            sheetURL: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRHsoqVm7cDIUgGw6u5n0yO8U19lyqKLrrskUn6Q7At1Q04hrXdC7HxojsDnxj7Frld2__eJOBBMEX6/pub?output=csv"
        };

        function createMemberCard(member, index, isPaid) {
            const isPremium = /Ø°Ù‡Ø¨ÙŠØ©|Ù…Ø§Ø³ÙŠØ©/i.test(member.plan);
            const shouldBlur = !isPaid;
            const verifiedTag = member.verified ? '<i class="fas fa-check-circle text-blue-400 ml-1"></i>' : '';
            
            return `
                <div class="member-card member-item" data-name="${member.name}" data-city="${member.city}" id="card-${index}">
                    <div class="img-box relative">
                        ${isPremium ? '<div class="premium-badge"><i class="fas fa-crown mr-1"></i> VIP</div>' : ''}
                        ${isPremium ? '<div class="online-dot dot-pulse"></div>' : ''}
                        
                        <img src="${member.img || 'https://ui-avatars.com/api/?name=' + member.name}" class="${shouldBlur ? 'blur-effect' : ''}" loading="lazy">
                        
                        ${shouldBlur ? `
                            <div class="blur-overlay" onclick="location.href='checkout.html'">
                                <div class="blur-text shadow-xl">ÙƒØ´Ù Ø§Ù„ØµÙˆØ±Ø© ğŸ”“</div>
                            </div>` : ''}
                    </div>
                    <div class="p-4 text-center">
                        <h4 class="font-black text-sm truncate text-slate-700 mb-1">${member.name} ${verifiedTag}</h4>
                        <p class="text-[10px] text-slate-400 mb-4 flex items-center justify-center gap-1">
                            <i class="fas fa-location-dot text-red-300"></i> ${member.city}
                        </p>
                        <div class="flex gap-2">
                            <button class="bg-red-50 text-red-600 w-10 h-10 flex items-center justify-center rounded-2xl transition-transform active:scale-90">ğŸŒ¹</button>
                            <button class="bg-green-600 text-white px-2 py-2 rounded-2xl text-[11px] font-black flex-1 shadow-lg active:scale-95 transition-all">ØªÙˆØ§ØµÙ„ Ø§Ù„Ø¢Ù† ğŸ’Œ</button>
                        </div>
                    </div>
                </div>`;
        }

        async function load() {
            try {
                const res = await fetch(`${CONFIG.sheetURL}?cb=${Date.now()}`);
                const data = await res.text();
                const rows = data.split('\n').slice(1);
                
                const grid = document.getElementById('membersGrid');
                const suggestGrid = document.getElementById('suggestGrid');
                const suggestSection = document.getElementById('suggestionSection');
                
                grid.innerHTML = "";
                suggestGrid.innerHTML = "";

                const myPlan = localStorage.getItem('userPlan') || 'Ø¹Ø§Ø¯ÙŠØ©';
                const myCity = localStorage.getItem('userCity') || ''; 
                const isPaidUser = /Ø§Ù„Ø³ØªØ±|Ø°Ù‡Ø¨ÙŠØ©|Ù…Ø§Ø³ÙŠØ©/i.test(myPlan);

                let hasSuggestions = false;
                let count = 0;

                rows.forEach((row, index) => {
                    const cols = row.split(',').map(c => c.trim().replace(/^"|"$/g, ''));
                    if(!cols[0] || cols[0].length < 2) return;
                    
                    const member = { 
                        name: cols[0], city: cols[3] || 'Ø§Ù„Ø³ÙˆØ¯Ø§Ù†', plan: cols[2] || 'Ø¹Ø§Ø¯ÙŠØ©', img: cols[6], verified: true 
                    };

                    const cardHTML = createMemberCard(member, index, isPaidUser);
                    count++;

                    if (myCity && member.city.includes(myCity) && member.name !== localStorage.getItem('userName')) {
                        suggestGrid.innerHTML += cardHTML;
                        hasSuggestions = true;
                    } else {
                        grid.innerHTML += cardHTML;
                    }
                });

                if(hasSuggestions) {
                    suggestSection.classList.remove('hidden');
                    document.getElementById('suggestTitle').innerText = `Ù…Ù‚ØªØ±Ø­Ø§Øª ÙÙŠ ${myCity}`;
                }

                document.getElementById('totalCountDisplay').innerText = `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: ${count}`;
                document.getElementById('onlineCount').innerText = Math.floor(count * 0.3);
                document.getElementById('loadingMembers').style.display = 'none';
            } catch (e) { console.error("Load Failed"); }
        }

        function filterMembers() {
            const val = document.getElementById('searchInput').value.toLowerCase();
            document.querySelectorAll('.member-item').forEach(card => {
                const name = card.getAttribute('data-name').toLowerCase();
                const city = card.getAttribute('data-city').toLowerCase();
                card.style.display = (name.includes(val) || city.includes(val)) ? 'flex' : 'none';
            });
        }

        let isPlaying = false;
        function toggleMusic() {
            const audio = document.getElementById('bgAudio');
            const btn = document.getElementById('musicToggle');
            if(isPlaying) { audio.pause(); btn.innerHTML = '<i class="fas fa-music"></i>'; }
            else { audio.play(); btn.innerHTML = '<i class="fas fa-pause"></i>'; }
            isPlaying = !isPlaying;
        }

        setInterval(() => {
            if(document.visibilityState !== 'visible') return;
            const h = document.createElement('div');
            h.className = 'heart-bg'; h.innerHTML = 'â¤ï¸';
            h.style.left = Math.random() * 100 + 'vw';
            h.style.animationDuration = (Math.random() * 3 + 2) + 's';
            document.getElementById('heartsContainer').appendChild(h);
            setTimeout(() => h.remove(), 5000);
        }, 1000);

        function logout() { if(confirm("Ù‡Ù„ ØªÙˆØ¯ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù…Ù†ØµØ©ØŸ")) { localStorage.clear(); location.href='index.html'; } }
        function toggleNotifications() { const p = document.getElementById('notificationPanel'); p.style.display = p.style.display === 'block' ? 'none' : 'block'; }
        
        window.onload = load;
    </script>
</body>
</html>
