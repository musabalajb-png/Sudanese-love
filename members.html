<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØµÙØ­ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ - Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        body { font-family: 'Cairo', sans-serif; }
        .member-card { transition: all 0.3s ease; }
        .member-card:hover { transform: translateY(-5px); }
        .blur-image { filter: blur(15px); }
    </style>
</head>
<body class="bg-gray-50">

    <nav class="bg-white shadow-sm p-4 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div class="text-2xl font-bold text-green-700">ğŸ’ Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</div>
            <div class="flex items-center gap-4">
                <a href="index.html" class="text-gray-500 font-bold">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            </div>
        </div>
    </nav>

    <header class="bg-white border-b p-6 shadow-sm">
        <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-4">
            <input type="text" id="nameSearch" onkeyup="filterMembers()" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¯ÙˆÙ„Ø©..." class="border p-3 rounded-2xl outline-none focus:ring-2 focus:ring-green-500">
            <select id="filterGender" onchange="filterMembers()" class="border p-3 rounded-2xl outline-none">
                <option value="all">Ø§Ù„ÙƒÙ„</option>
                <option value="Ø°ÙƒØ±">Ø°ÙƒØ±</option>
                <option value="Ø£Ù†Ø«Ù‰">Ø£Ù†Ø«Ù‰</option>
            </select>
            <select id="filterCity" onchange="filterMembers()" class="border p-3 rounded-2xl outline-none">
                <option value="all">ÙƒÙ„ Ø§Ù„Ø¯ÙˆÙ„</option>
                <option value="Ø§Ù„Ø³ÙˆØ¯Ø§Ù†">Ø§Ù„Ø³ÙˆØ¯Ø§Ù†</option>
                <option value="Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©">Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
                <option value="Ø£ÙˆØ±ÙˆØ¨Ø§">Ø£ÙˆØ±ÙˆØ¨Ø§</option>
            </select>
            <button onclick="resetFilters()" class="bg-gray-100 text-gray-600 font-bold rounded-2xl py-3 hover:bg-gray-200">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
        </div>
    </header>

    <main class="max-w-6xl mx-auto py-10 px-4">
        <div id="loading" class="text-center py-20 text-gray-400 font-bold animate-pulse">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        <div id="membersList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8"></div>
    </main>

    <script>
        let allMembers = [];
        const dbURL = "https://naseeb-project-1030a-default-rtdb.asia-southeast1.firebasedatabase.app/members.json";

        async function loadMembers() {
            try {
                const response = await fetch(dbURL);
                const data = await response.json();
                document.getElementById('loading').classList.add('hidden');
                if (data) {
                    allMembers = Object.keys(data).map(key => ({ id: key, ...data[key] }));
                    displayMembers(allMembers);
                }
            } catch (error) { console.error(error); }
        }

        function displayMembers(data) {
            const list = document.getElementById('membersList');
            list.innerHTML = "";
            data.forEach(m => {
                const card = `
                    <div class="member-card bg-white rounded-[2rem] shadow-sm border border-gray-100 overflow-hidden">
                        <div class="h-64 relative overflow-hidden text-center">
                            <img src="${m.image || 'https://via.placeholder.com/400x500'}" class="w-full h-full object-cover blur-image">
                            <div class="absolute inset-0 bg-black/40 flex items-center justify-center text-white text-[10px]">ğŸ”’ ØµÙˆØ±Ø© Ø®Ø§ØµØ©</div>
                        </div>
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-xl text-gray-800">${m.name}</h3>
                                <span class="bg-green-50 text-green-700 text-xs px-2 py-1 rounded-lg font-bold">${m.age} Ø³Ù†Ø©</span>
                            </div>
                            <p class="text-gray-500 text-xs mb-4">ğŸ“ ${m.city} | ${m.status}</p>
                            
                            <div class="grid grid-cols-2 gap-2 mb-3">
                                <button onclick="handleChat('${m.name}', 'Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª')" class="bg-blue-50 text-blue-600 text-[10px] py-2 rounded-xl font-bold">ğŸ’¬ Ø´Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                                <button onclick="handleChat('${m.name}', 'Ø§Ù„ØµÙˆØ±')" class="bg-pink-50 text-pink-600 text-[10px] py-2 rounded-xl font-bold">ğŸ–¼ï¸ Ø´Ø§Øª Ø§Ù„ØµÙˆØ±</button>
                            </div>

                            <div class="flex gap-2">
                                <button onclick="sendGift('${m.name}')" class="flex-1 border border-red-100 text-red-500 py-3 rounded-xl text-xs font-bold hover:bg-red-50 transition">â¤ï¸ Ø¥Ø±Ø³Ø§Ù„ Ù†Ø¨Ø¶</button>
                                <button onclick="startVideoCall('${m.name}')" class="bg-green-700 text-white px-4 py-3 rounded-xl hover:bg-green-800 transition shadow-md">ğŸ¥</button>
                            </div>
                        </div>
                    </div>
                `;
                list.innerHTML += card;
            });
        }

        function handleChat(name, type) {
            let msg = prompt(`Ø£Ù†Øª Ø§Ù„Ø¢Ù† ÙÙŠ Ø´Ø§Øª Ù…Ø¨Ø§Ø´Ø± Ù…Ø¹ ${name} Ø¨Ø®ØµÙˆØµ ${type}. \nØ§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ:`);
            
            if (msg) {
                const contactBlocker = /[0-9]{7,}|[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/;
                if (contactBlocker.test(msg)) {
                    alert("âš ï¸ Ø®Ø·Ø£ Ø£Ù…Ù†ÙŠ: ÙŠÙ…Ù†Ø¹ Ù…Ø´Ø§Ø±ÙƒØ© Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ. Ø§Ù„ØªÙˆØ§ØµÙ„ ÙŠØªÙ… Ø¹Ø¨Ø± Ø§Ù„Ù…Ù†ØµØ© ÙÙ‚Ø·.");
                    return;
                }
                alert(`ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ Ù„Ù€ ${name}.`);
            }
        }

        function startVideoCall(name) {
            alert(`ğŸ¥ Ø§ØªØµØ§Ù„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ø¹ ${name} Ù…ØªØ§Ø­ Ù„Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© ÙÙ‚Ø·. ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„ØªØ±Ù‚ÙŠØ©.`);
        }

        function sendGift(name) {
            alert(`ØªÙ… Ø¥Ø±Ø³Ø§Ù„ â¤ï¸ Ù„Ù€ ${name}`);
        }

        function filterMembers() {
            const name = document.getElementById('nameSearch').value.toLowerCase();
            const gender = document.getElementById('filterGender').value;
            const city = document.getElementById('filterCity').value;
            const filtered = allMembers.filter(m => (gender === 'all' || m.gender === gender) && (city === 'all' || m.city.includes(city)) && m.name.toLowerCase().includes(name));
            displayMembers(filtered);
        }

        function resetFilters() {
            document.getElementById('nameSearch').value = "";
            document.getElementById('filterGender').value = "all";
            document.getElementById('filterCity').value = "all";
            displayMembers(allMembers);
        }

        window.onload = loadMembers;
    </script>
</body>
</html>
