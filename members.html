<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØµÙØ­ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ | Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        .blur-img { filter: blur(20px); transform: scale(1.1); transition: 0.5s; }
        .member-card { border-radius: 2rem; overflow: hidden; background: white; transition: 0.3s; }
        .member-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="bg-slate-50">
    <script>
        // ğŸ”’ Ø­Ø§Ø±Ø³ Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ù„Ø­Ø¸ÙŠ
        if(localStorage.getItem('naseeb_logged') !== 'true') {
            alert("ğŸ”’ ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹");
            window.location.href = "index.html";
        }
    </script>

    <nav class="bg-white p-4 shadow-sm sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <a href="index.html" class="font-bold text-green-700">ğŸ’ Ù†ØµÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</a>
            <button onclick="localStorage.clear(); location.href='index.html'" class="text-xs bg-red-50 text-red-600 px-3 py-1 rounded-full">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>
    </nav>

    <div class="container mx-auto p-6">
        <input type="text" id="search" onkeyup="filter()" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©..." class="w-full max-w-md mx-auto block p-4 rounded-2xl border-none shadow-sm mb-10">
        <div id="list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </div>

    <script>
        const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRHsoqVm7cDIUgGw6u5n0yO8U19lyqKLrrskUn6Q7At1Q04hrXdC7HxojsDnxj7Frld2__eJOBBMEX6/pub?output=csv";
        
        async function load() {
            const res = await fetch(sheetURL);
            const data = await res.text();
            const rows = data.split('\n').slice(1);
            const list = document.getElementById('list');
            const isPaid = /Ø§Ù„Ø³ØªØ±|Ø°Ù‡Ø¨ÙŠØ©|Ù…Ø§Ø³ÙŠØ©/i.test(localStorage.getItem('userPlan'));

            rows.forEach(row => {
                // ğŸ› ï¸ Ø­Ù„ Ø«ØºØ±Ø© Ø§Ù„ÙÙˆØ§ØµÙ„ ÙÙŠ CSV
                const cols = row.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g)?.map(c => c.replace(/"/g, '').trim()) || [];
                if(cols.length < 5) return;

                const m = { name:cols[0], age:cols[1], city:cols[4], plan:cols[5], img:cols[6] };
                list.innerHTML += `
                    <div class="member-card border">
                        <div class="h-64 overflow-hidden bg-gray-100">
                            <img src="${m.img}" onerror="this.src='https://ui-avatars.com/api/?name=${m.name}'" class="w-full h-full object-cover ${isPaid ? '' : 'blur-img'}">
                        </div>
                        <div class="p-5 text-center">
                            <h3 class="font-bold">${m.name}</h3>
                            <p class="text-[10px] text-gray-400">${m.age} Ø³Ù†Ø© - ${m.city}</p>
                            <button onclick="contact('${m.name}')" class="mt-4 w-full bg-green-600 text-white py-2 rounded-xl text-sm font-bold">ØªÙˆØ§ØµÙ„</button>
                        </div>
                    </div>`;
            });
        }
        function contact(n) { window.open(`https://wa.me/249127910778?text=Ø£Ù†Ø§ Ø§Ù„Ù…Ø´ØªØ±Ùƒ ${localStorage.getItem('userName')} Ø£Ø±ØºØ¨ ÙÙŠ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ ${n}`, '_blank'); }
        function filter() {
            const q = document.getElementById('search').value.toLowerCase();
            document.querySelectorAll('#list > div').forEach(c => c.style.display = c.innerText.toLowerCase().includes(q) ? 'block' : 'none');
        }
        window.onload = load;
    </script>
</body>
</html>
